
BODY='{"author":"Desire Amagwula", "quote_string":"You only get one chance to live, make the most of it", "category":["inspirational", "life-changing"]}'
BODY='{"author":"JK Rowling", "quote_string":"Fear of a name increases fear of the thing itself.", "category":["inspirational", "life-changing"]}'
BODY='{"author":"Vachel Lindsay", "quote_string":"Never be a cynic, even a gentle one. Never help out a sneer, even at the devil.", "category":["inspirational", "life-changing"]}'
BODY='{"author":"Leonardo Divinci", "quote_string":"Simplicity is the ultimate sophistication", "category":["inspirational", "life-changing"]}'
BODY='{"author":"Henry Ford", "quote_string":"The only real mistake is the one from which we learn nothing", "category":["inspirational", "life-changing"]}'
BODY='{"author":"Albert Einstein", "quote_string":"Creativity is intelligence having fun.", "category":["inspirational", "life-changing"]}'
BODY='{"author":"Winston Churchill", "quote_string":"If youâ€™re going through hell, keep going.", "category":["inspirational", "life-changing"]}'



BODY='{"name":"Andrew Thomas", "email":"appletree2022@gmail.com", "password":"appletree"}'
BODY='{"name":"Matthew Gruber", "email":"mattgruber@gmail.com", "password":"hate2001"}'
BODY='{"name":"James Garner", "email":"jamesgarner@gmail.com", "password":"james2001"}'
BODY='{"name":"Kaitlyn Spades", "email":"kaitlynspades@gmail.com", "password":"kaitlyn2000"}'
BODY='{"name":"Junior Francisco", "email":"junior@gmail.com", "password":"junior2001"}'
BODY='{"name":"Holland Thomas", "email":"hollandthomas@gmail.com", "password":"holland2001"}'
BODY='{"name":"Claire Voyant", "email":"clairevoyant@gmail.com", "password":"claire2001"}'


curl -i -d "$BODY" localhost:4000/v1/Quotes (insert into the database)
curl localhost:4000/v1/Quotes (show the database)
curl -i localhost:4000/v1/Quotes/1 
curl -X PATCH -d '{"author":"Desire Amagwula"}' localhost:4000/v1/Quotes/1
curl -X DELETE localhost:4000/v1/Quotes/2
curl -w '\nTime: %{time_total}s \n' -i localhost:4000/v1/Quotes/1
curl "localhost:4000/v1/Quotes?sort=author"
curl "localhost:4000/v1/Quotes?page=1&page_size=20"
curl "localhost:4000/v1/Quotes?page=1220&page_size=200&sort=author"
curl "localhost:4000/v1/Quotes?page=0&page_size=-1&sort=author"

Rate limiting
for i in {1..6}; do curl http://localhost:4000/v1/healthcheck; done

Graceful shutdown
curl localhost:4000/v1/healthcheck & pkill -SIGTERM api

Create new User
curl -w '\nTime: %{time_total}\n' -d "$BODY" localhost:4000/v1/users

curl -X PUT -d '{"token":"4E6MC6CVLFBO3O2IZJ6XMAIPUA"}' localhost:4000/v1/users/activated

Authorization
BODY='{"email":"kaitlynspades@gmail.com", "password":"kaitlyn2000"}' 
curl -i -d "$BODY" localhost:4000/v1/tokens/authentication

BODY='{"email":"kaitlynspades@gmail.com", "password":"kaitlyn2000"}'
BODY='{"email":"mattgruber@gmail.com", "password":"hate2001"}'


{
        "authentication token": {
                "token": "QE72JSC7GKRYPEB5JCZAWXIWYU",
                "expiry": "2022-12-04T14:21:20.512217812-06:00"
        }
}

curl -H "Authorization: Bearer QE72JSC7GKRYPEB5JCZAWXIWYU" localhost:4000/v1/healthcheck


1.) Give all users read permission
INSERT INTO users_permissions
SELECT id, (SELECT id FROM permissions WHERE code = 'quotes:read') FROM users;

2.) Give user panda permission to write 
INSERT INTO users_permissions(user_id, permission_id)
VALUES (
(SELECT id FROM users WHERE email = 'kaitlynspades@gmail.com'),
(SELECT id FROM permissions WHERE code = 'quotes:write')
);

3. List the activated users and their permissions
SELECT email, array_agg(permissions.code) AS permissions
FROM permissions
INNER JOIN users_permissions
ON users_permissions.permission_id = permission_id
INNER JOIN users
ON users_permissions.user_id = users.id
WHERE users.activated = true; 

4. Test the endpoints to verify that they work

Matthew Gruber (read)

{
        "authentication token": {
                "token": "4E6MC6CVLFBO3O2IZJ6XMAIPUA",
                "expiry": "2022-12-04T17:22:59.827449809-06:00"
        }
}

curl -i -d "$BODY" -H "Authorization: Bearer QE72JSC7GKRYPEB5JCZAWXIWYU" localhost:4000/v1/Quotes

curl -i -d "$BODY" localhost:4000/v1/tokens/authentication

curl -X DELETE -H "Authorization: Bearer 4E6MC6CVLFBO3O2IZJ6XMAIPUA" localhost:4000/v1/Quotes/2